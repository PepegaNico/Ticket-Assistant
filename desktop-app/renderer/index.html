<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline';">
    <title>Remedy Ticket Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1>üé´ Remedy Ticket Assistant</h1>
                <div class="header-status">
                    <span id="backend-status" class="status-badge">‚è≥ Checking...</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="nav-menu">
                    <button class="nav-item active" data-view="tickets">
                        <span class="nav-icon">üìã</span>
                        <span class="nav-label">Tickets</span>
                    </button>
                    <button class="nav-item" data-view="translator">
                        <span class="nav-icon">üåê</span>
                        <span class="nav-label">Translator</span>
                    </button>
                    <button class="nav-item" data-view="ai-assistant">
                        <span class="nav-icon">ü§ñ</span>
                        <span class="nav-label">AI Assistant</span>
                    </button>
                    <button class="nav-item" data-view="settings">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span class="nav-label">Settings</span>
                    </button>
                </nav>
                
                <div class="sidebar-footer">
                    <div class="version-info">
                        <small>Version 1.0.0</small>
                    </div>
                </div>
            </aside>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Tickets View -->
                <div id="tickets-view" class="view-panel active">
                    <h2>Ticket Simulation</h2>
                    <div class="ticket-form">
                        <div class="form-section">
                            <div class="ticket-header-info">
                                <div class="info-item">
                                    <label>Incident Number</label>
                                    <span>INC000012345678</span>
                                </div>
                                <div class="info-item">
                                    <label>Status</label>
                                    <span class="badge badge-warning">In Progress</span>
                                </div>
                                <div class="info-item">
                                    <label>Priority</label>
                                    <span class="badge badge-medium">Medium</span>
                                </div>
                            </div>
                        </div>

                        <input type="hidden" id="customer-language" value="de">

                        <div class="form-row">
                            <label for="template">Template</label>
                            <select id="template">
                                <option value="">-- Select Template --</option>
                                <option value="password-reset">Password Reset</option>
                                <option value="software-installation">Software Installation</option>
                                <option value="hardware-issue">Hardware Issue</option>
                                <option value="network-problem">Network Problem</option>
                                <option value="access-request">Access Rights Request</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <label for="title">Title
                                <button class="inline-btn" id="btn-suggest-questions">ü§ñ Get AI Suggestions</button>
                            </label>
                            <input type="text" id="title" placeholder="Brief description" value="User cannot access shared folder">
                        </div>

                        <div class="form-row">
                            <label for="description">Description</label>
                            <textarea id="description" rows="4">User Max Mustermann reports that he cannot access the shared folder \\fileserver\projects since this morning. Error message: Access denied.</textarea>
                        </div>

                        <div class="form-row">
                            <label for="activity-notes">Activity Notes
                                <button class="inline-btn" id="btn-generate-resolution">‚ú® Generate Resolution</button>
                            </label>
                            <textarea id="activity-notes" rows="4">Called customer at 10:30. Customer confirmed the issue. Checked AD permissions - user is member of correct group.</textarea>
                        </div>

                        <div class="form-row">
                            <label for="resolution">Resolution
                                <button class="inline-btn" id="btn-translate">üåê Translate</button>
                            </label>
                            <textarea id="resolution" rows="6">The issue was caused by a recent change in the folder permissions. I have re-added the user to the correct security group and verified access. The user can now successfully access the shared folder. Please contact the service desk if you experience any further issues.</textarea>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary">Save</button>
                            <button class="btn btn-success">Submit</button>
                            <button class="btn btn-secondary">Cancel</button>
                        </div>
                    </div>
                </div>

                <!-- Translator View -->
                <div id="translator-view" class="view-panel">
                    <h2>Quick Translator</h2>
                    <div class="translator-panel">
                        <div class="translator-section">
                            <label>From Language</label>
                            <select id="source-lang">
                                <option value="auto">Auto-detect</option>
                                <option value="en" selected>English</option>
                                <option value="de">German</option>
                                <option value="fr">French</option>
                                <option value="es">Spanish</option>
                            </select>
                            <textarea id="source-text" rows="8" placeholder="Enter text to translate..."></textarea>
                        </div>
                        
                        <div class="translator-arrow">‚Üí</div>
                        
                        <div class="translator-section">
                            <label>To Language</label>
                            <select id="target-lang">
                                <option value="de" selected>German</option>
                                <option value="en">English</option>
                                <option value="fr">French</option>
                                <option value="es">Spanish</option>
                            </select>
                            <textarea id="target-text" rows="8" placeholder="Translation will appear here..." readonly></textarea>
                        </div>
                    </div>
                    <div class="translator-actions">
                        <button class="btn btn-primary" id="btn-quick-translate">Translate</button>
                        <button class="btn btn-secondary" id="btn-clear-translator">Clear</button>
                    </div>
                </div>

                <!-- AI Assistant View -->
                <div id="ai-assistant-view" class="view-panel">
                    <h2>AI Assistant</h2>
                    <div class="ai-panel">
                        <div class="feature-card">
                            <h3>ü§ñ Question Suggestions</h3>
                            <p>Get AI-powered question suggestions based on ticket information.</p>
                            <div class="card-content" id="questions-result"></div>
                        </div>
                        
                        <div class="feature-card">
                            <h3>‚ú® Resolution Generator</h3>
                            <p>Generate resolution text automatically in customer's language.</p>
                            <div class="card-content" id="resolution-result"></div>
                        </div>

                        <div class="ai-info">
                            <p><strong>üí° All AI processing runs locally using Ollama</strong></p>
                            <p>No data is sent to external services. Requires Ollama to be installed with a model.</p>
                        </div>
                    </div>
                </div>

                <!-- Settings View -->
                <div id="settings-view" class="view-panel">
                    <h2>Settings</h2>
                    <div class="settings-panel">
                        <div class="setting-group">
                            <h3>Backend Service</h3>
                            <div class="setting-item">
                                <label>Backend URL</label>
                                <input type="text" id="backend-url" value="http://localhost:5000" readonly>
                                <small>Backend starts automatically with the application</small>
                            </div>
                            <div class="setting-item">
                                <button class="btn btn-secondary" id="btn-test-backend">Test Connection</button>
                                <div id="test-result" class="test-result"></div>
                            </div>
                        </div>

                        <div class="setting-group">
                            <h3>Features</h3>
                            <ul class="feature-list">
                                <li>‚úÖ Translation (Google Translate - free)</li>
                                <li>‚úÖ AI Question Suggestions (Local Ollama)</li>
                                <li>‚úÖ AI Resolution Generation (Local Ollama)</li>
                                <li>üîí 100% Local Processing</li>
                            </ul>
                        </div>

                        <div class="setting-group">
                            <h3>About</h3>
                            <p><strong>Remedy Ticket Assistant</strong></p>
                            <p>Version: 1.0.0</p>
                            <p>A 100% local AI-powered assistant for service desk agents.</p>
                            <p>All data stays on your machine. No external APIs. GDPR compliant.</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="translation-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Translation Preview</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="translation-preview">
                    <div class="preview-section">
                        <label>Original</label>
                        <div id="preview-original" class="preview-text"></div>
                    </div>
                    <div class="preview-arrow">‚Üì</div>
                    <div class="preview-section">
                        <label id="preview-target-label">Translated</label>
                        <div id="preview-translated" class="preview-text"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="modal-accept">Use Translation</button>
            </div>
        </div>
    </div>

    <div id="questions-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ü§ñ AI-Suggested Questions</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Ask these questions to better understand the issue:</p>
                <ol id="questions-list" class="questions-list"></ol>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="questions-ok">OK</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
